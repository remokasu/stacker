
[**英語  (English)**](https://github.com/remokasu/stacker/blob/main/README.md)


```
  _____  _                 _
 / ____|| |               | |
| (___  | |_   __ _   ___ | | __  ___  _ __
 \___ \ | __| / _` | / __|| |/ / / _ \| '__|
 ____) || |_ | (_| || (__ |   < |  __/| |
|_____/  \__| \__,_| \___||_|\_\ \___||_|
```

## 概要

ある晴れた日、学生Aは数学の試験に挑むため、緊張しながら教室へ向かっていました。しかし、彼はある重要なものを忘れてしまっていたのです。それは、関数電卓でした。

<br>

- 学生A（焦りながら）
    ~~~
    先生、電卓を忘れちゃったんですが、お借りできますか？
    ~~~

- 教授（待ってました！と言いたげな表情で）
    ~~~
    もちろんだ。特別に君にコレを貸してあげよう。
    ヒューレットパッカードの稀代の名機 「hp 50G」！！
    とっくに生産終了してしまって今では新品で買うことなど不可能なシロモノだ。
    Amaz●nではプレミアがついて10倍の値段で取引されている。
    このでっかい画面にはグラフも描画できちゃうぞ！
    さらにこの小さな端子はなななななんとRS-232！シリアル通信だってできちゃう！
    電卓のくせに一体何と通信するんだろうねぇ！？
    まあ、何故かコネクタは公式から発売されることは無かったから実質幻の機能だがな...
    どうだ？凄いだろう？
    ~~~

- 学生A（顔を輝かせつつ）
    ~~~
    ええっ！なにそれチートアイテムぅ！？（よく分かんないけど凄そう！デカイし！)
    やったあ...これで試験も余裕です！！(泣）
    ~~~

- 教授（ニヤリと笑いながら）
    ~~~
    ただし、これは逆ポーランド記法の電卓だぞ
    ~~~

- 学生A（戸惑いつつ）
    ~~~
    逆ポ...？逆ポーランドって何です？よく分かんないけど、なんかカッコいいですね！
    ~~~

- 教授（クスクス笑い）
    ~~~
    ちょっと普通の電卓とは扱い方が異なるだけだ。
    なに、心配することはないよ。普通の電卓のようなモードにも切り替えられるからね。
    ~~~

- 学生A（安心しながら）
    ~~~
    なるほど！ありがとうございます！！たすかりましたああ！！
    ~~~

- 教授（声には出さず）
    ~~~
    （ただし切り替え方は初見では分かり難いだろうねｸｸｸ...）
    ~~~


<br>
その試験で学生Aは泣いたという。

このプログラムは、A君のトラウマを追体験することができる。


## インストール

### 前提条件:
Python 3がインストールされていることを確認してください。

### インストールオプション:

- pip経由:
    ```bash
    pip install pystacker
    ```

- ソースから:
    ```bash
    git clone git@github.com:remokasu/stacker.git
    cd stacker
    python setup.py install
    ```

- 遊び終わったら削除しましょう
    ~~~ bash
    > pip uninstall pystacker
    ~~~

## フィードバック

フィードバックを歓迎します。[Issuesページ](https://github.com/remokasu/stacker/issues)で問題や提案を提出してください。

## 依存関係

Stackerは`NumPy`や`Python Prompt Toolkit`などの外部ライブラリを使用します。以下のコマンドでインストールしてください:
```bash
pip install numpy prompt_toolkit
```

## 使用方法

Stackerの実行:
```bash
stacker
```
または:
```bash
python -m stacker
```

Stackerは標準的な算術演算（+、-、*、/）と高度な関数（sin、cos、tanなど）をサポートしています。ユーザーはRPN形式でコマンドを入力し、カスタムプラグインを使用して機能を拡張できます。

### 入力例

StackerのRPN入力の例を示します

- シングルライン入力:
  ```bash
  stacker:0> 3 4 +
  [7]
  ```

- マルチライン入力:
  ```bash
  stacker:0> 3
  [3]
  stacker:1> 4
  [3, 4]
  stacker:2> +
  [7]
  ```

- 逆ポーランドなんてクソ喰らえだ
    
    中置記法を文字列として入力し、`eval`を使用して評価することができます。 
    ```
    tacker:0> "3+5" eval
    [8]
    ```
    中置記法式を入力する場合、このような入力は不可能です。
    ```
    tacker:0> 3 + 5 eval
    [ERROR]: Not enough operands for operator '+'
    ```
    やはり中置記法こそ正義なのです。 <br>
    ところで、なんで君はStackerを使ってるんですか？


### スクリプトの実行
Stackerスクリプトは*stkファイルで作成できます。スクリプトを実行するには、次の様に実行ファイルを指定します。
```bash
stacker my_script.stk
```

## プラグインの作成

Pythonを使用してStackerのカスタムプラグインを作成します。

1. `plugins`ディレクトリに新しいPythonファイルを作成します（例：`my_plugin.py`）
    ``` 
    stacker/
    │
    ├── stacker/
    │   ├── plugins/
    │   │   ├── my_plugin.py
    │   │   └── ...
    │   │
    │   ├── data/
    │   ├── stacker.py
    │   ├── test.py
    │   └── ...
    │
    └── ...
    ```

    ここにプラグインを追加し、Stackerを再インストールすると、プラグインが恒久的に適用されます。

2. または、Stackerを実行しているディレクトリに`plugins`ディレクトリを作成します。これにより、再インストールせずにプラグインを使用できます。
3. プラグインファイル内に必要な関数やクラスを定義します。
4. これらをStackerに登録するために`setup`関数を追加します。

例：
```python
from stacker.stacker import Stacker

def function(a, b):
    # 何かの処理

def setup(stacker: Stacker):
    stacker.register_plugin("command", function)
```

## ドキュメント
より詳細なドキュメントについては、[`stacker/docs`](https://github.com/remokasu/stacker/blob/main/docs/README.md)を参照してください。
